# ðŸ—ï¸ System Architecture

This project uses a **Hybrid Architecture** to balance performance, cost, and functionality.

## The "Scale-to-Zero" Concept

Typical web apps run a server 24/7. This costs money ($7/mo+).
**We want to pay $0.**

To achieve this, we use **Render's Free Tier**, which "sleeps" after 15 minutes of inactivity.
*   **Problem**: If the server sleeps, the first visitor waits 50+ seconds for it to wake up.
*   **Solution**: We generate a **Static Site** (HTML files) and host it on **Cloudflare Pages** (always online, fast). The Rust backend is *only* used for the **Admin Panel**.

## System Flow Diagram


```mermaid
graph TD
    User[visitor] -->|Visits stefmeul.net| CF[Cloudflare Pages\n(Global CDN)]
    CF -->|Serves| Static[Static HTML\n(Instant Load)]
    
    Admin[You / Admin] -->|Visits stefmeul.net/admin| Redir[Redirect Rule]
    Redir -->|Redirects to| Render[Render Backend\n(Rust API)]
    
    Render -->|Queries| DB[Neon Postgres\n(Serverless DB)]
    Render -->|Uploads| Cloud[Cloudinary\n(Images/Media)]
    
    subgraph "Deployment Pipeline"
        Render -->|User clicks 'Deploy'| GH[GitHub Actions]
        GH -->|Builds Static Site| Generator[gen_static.rs]
        Generator -->|Fetches Data| DB
        Generator -->|Pushes HTML| Branch[gh-pages Branch]
        Branch -->|Triggers| CF
    end
```

## Component Roles

### 1. The Public Frontend (Cloudflare Pages)
*   **Role**: Show the portfolio to the world.
*   **Tech**: Plain HTML/CSS files generated by our Rust tool.
*   **Pros**: 
    *   Zero loading latency.
    *   Immune to traffic spikes.
    *   Free.

### 2. The Admin Backend (Render)
*   **Role**: Allow you to add/edit projects, upload images, and reorder blocks.
*   **Tech**: Rust (Axum) application using Server-Side Rendering.
*   **Behavior**: Naps when you aren't using it. Wakes up when you go to `/admin`.

### 3. The Deployment Bridge (GitHub Actions)
*   **Role**: Keeps the Static Site in sync with the Database.
*   **Trigger**: You click "Deploy Live" in the Admin Dashboard.
*   **Action**: A script runs `cargo run --bin gen_static`, rendering all your projects to HTML files, and publishing them to the web.
